# NIP-50

## 搜索功能

`draft` `optional` `author:brugeman` `author:mikedilger` `author:fiatjaf`

## 摘要（Abstract）

许多 Nostr 用例需要某种形式的通用搜索功能，除了按标签或 ids 的结构化查询外。搜索算法的具体内容在不同的事件类型中会有所不同，这个 NIP 只描述了一个执行这种查询的通用可扩展框架。

### `search` 过滤字段

为来自客户端的 `REQ` 消息引入了一个新的 `search` 字段。

```json
{
  ...
  "search": <string>
}
```

`search` 字段是一个字符串，以人类可读的形式描述一个查询，限 “最好的 nostr 应用程序”。中继器**应该**尽其所能解释查询，并返回与之匹配的事件。中继器**应该**对 `content` 事件字段进行匹配，也**可以**对其他字段进行匹配，如果这在特定种类的背景下是合理的。

一个包含 `key:value` 键值对的查询字符串（两个词通过冒号分开），这些是扩展，中继器**应该**忽略他们不支持的扩展。

客户端可以指定几个搜索过滤器，即 `["REQ", "", { "search": "orange" }, { "kinds": [1, 2], "search": "purple" }]`。客户端可 c 包括 `kinds`、`ids` 和其他过滤器字段，将搜索结果限制在特定的事件种类上。

客户端**应该**使用 `supported_nips` 字段来了解一个中继器是否支持 `search` 过滤器。如果客户端准备过滤掉不支持该 NIP 的中继的不相干的响应，他们**可以**向任何中继器发送 `search` 过滤器查询。

客户端**应该**查询支持该 NIP 的几个中继器，以补偿中继器之间可能不同的实现细节。

客户端**可以**验证中继器返回的事件是否与指定的查询相匹配，以适合客户端的使用情况，并且**可能**会停止查询具有低精度的中继器。

如果中继器支持某种形式的垃圾邮件过滤，中继器**应该**默认将垃圾邮件从搜索结果中排除。

## 扩展

中继器**可以**支持这些扩展：

  - `include:spam` - 关闭垃圾邮件过滤，如果它在默认情况下是开启的。

